<nz-card [nzTitle]="record ? 'Cập nhật' : 'Tạo mới'">
  <form [formGroup]="saveForm" nz-form autocomplete="off">
    <!--phone_number-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24"
                     nzRequired nzFor="login_id">
        Login ID
      </nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input nz-input
               *ngIf="!record"
               formControlName="login_id"
               autocomplete="new-input"
               id="login_id"/>

        <span *ngIf="record">
          {{record.login_id}}
          <span class="cl-red" *ngIf="!record.is_active">( Đã xóa )</span>
        </span>

        <app-control-errors
          fieldName="login_id"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--full_name-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzRequired nzFor="full_name">Tên</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input *ngIf="!record || (record && record.is_active)" nz-input formControlName="full_name" id="full_name"/>
        <span *ngIf="record && !record.is_active">{{record.full_name}}</span>

        <app-control-errors
          fieldName="full_name"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--email-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="email" nzRequired>Email</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input *ngIf="!record || (record && record.is_active)" nz-input formControlName="email" id="email"/>
        <span *ngIf="record && !record.is_active">{{record.email}}</span>

        <app-control-errors
          fieldName="email"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--password-->
    <nz-form-item *ngIf="!record || (record && record.is_active)">
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="password">Mật khẩu</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-input-group [nzSuffix]="suffixTemplate">
          <input
            [type]="passwordVisible ? 'text' : 'password'"
            nz-input
            formControlName="password"
            autocomplete="new-password"
            id="password"
          />
        </nz-input-group>
        <ng-template #suffixTemplate>
          <span
            nz-icon
            [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
            (click)="passwordVisible = !passwordVisible"
          ></span>
        </ng-template>
        <app-control-errors
          fieldName="password"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--confirm password-->
    <nz-form-item *ngIf="!record || (record && record.is_active)">
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="password_confirmation">Xác nhận mật khẩu</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-input-group [nzSuffix]="suffixTemplateConfirm">
          <input
            [type]="passwordVisibleConfirm ? 'text' : 'password'"
            nz-input
            autocomplete="new-password"
            formControlName="password_confirmation"
            id="password_confirmation"
          />
        </nz-input-group>
        <ng-template #suffixTemplateConfirm>
          <span
            nz-icon
            [nzType]="passwordVisibleConfirm ? 'eye-invisible' : 'eye'"
            (click)="passwordVisibleConfirm = !passwordVisibleConfirm"
          ></span>
        </ng-template>
        <app-control-errors
          fieldName="password_confirmation"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--Team-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="role_id">Nhóm</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-select
          *ngIf="!record || (record && record.is_active)"
          nzPlaceHolder="Vui lòng chọn"
          formControlName="team_id"
          nzAllowClear
        >
          <nz-option *ngFor="let item of teams" [nzLabel]="$any(item.name)"
                     [nzValue]="$any(item?.id)"></nz-option>
        </nz-select>
        <span *ngIf="record && !record.is_active">{{getNameTeam(record.team_id)}}</span>
      </nz-form-control>
    </nz-form-item>

    <!--Role-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="role_id" nzRequired>Phân quyền</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-select
          *ngIf="!record; else updateTemplate"
          nzPlaceHolder="Vui lòng chọn"
          formControlName="role_id"
          nzAllowClear
        >
          <nz-option *ngFor="let item of roles" [nzLabel]="$any([roleEnum[item.name]])"
                     [nzValue]="$any(item?.id)"></nz-option>
        </nz-select>

        <ng-template #updateTemplate>
          {{record.role ? [roleEnum[record.role[0].name]] : ''}}
        </ng-template>
        <app-control-errors
          fieldName="role_id"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <div nz-row>
      <div nz-col [nzSpan]="24" class="create-area">
        <button nz-button [routerLink]="['', 'staff']">Quay lại</button>
        <button nz-button nzType="primary"
                *ngIf="!record || (record && record.is_active)"
                [nzLoading]="isLoading"
                (click)="confirmUpdate()"
                [disabled]="!saveForm.valid">
          {{record ? 'Cập nhật' : 'Tạo mới'}}
        </button>
      </div>
    </div>
  </form>
</nz-card>
