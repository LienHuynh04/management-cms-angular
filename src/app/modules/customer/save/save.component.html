<nz-card [nzTitle]="record ? 'Cập nhật' : 'Tạo mới'">
  <form [formGroup]="saveForm" nz-form>
    <!--full_name-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzRequired nzFor="full_name">Tên khách hàng</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input nz-input formControlName="full_name" id="full_name"/>
        <app-control-errors
          fieldName="full_name"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--phone_number-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzRequired nzFor="phone_number">Số điện thoại</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input nz-input formControlName="phone_number" id="phone_number"/>
        <app-control-errors
          fieldName="phone_number"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--address-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzRequired nzFor="address">Địa chỉ</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input nz-input formControlName="address" id="address"/>
        <app-control-errors
          fieldName="address"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--email-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="email">Email</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <input nz-input formControlName="email" id="email"/>
        <app-control-errors
          fieldName="email"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--staff-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="assign_for_user_id" nzRequired>Chỉ định nhân viên</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-select
          *ngIf="!record && !['sales'].includes(authService.currentUserValue.role[0].name); else assignCurrentUser"
          nzPlaceHolder="Vui lòng chọn"
          formControlName="assign_for_user_id"
          nzAllowClear
        >
          <nz-option *ngFor="let item of users"
                     [nzLabel]="item.full_name"
                     [nzValue]="item.id"></nz-option>
        </nz-select>
        <ng-template #assignCurrentUser>
          {{record ? record.assign_for_user?.full_name : users[0].full_name}}
        </ng-template>
        <app-control-errors
          fieldName="assign_for_user_id"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--created_at -->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="created_day" nzRequired>Ngày tạo khách hàng</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-date-picker [nzFormat]="'dd/MM/yyyy'"
                        nzPlaceHolder="Chọn ngày"
                        formControlName="created_day"></nz-date-picker>
        <app-control-errors
          fieldName="created_day"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--project_note-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="project_note">Ghi chú dự án</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <textarea rows="4" nz-input formControlName="project_note" id="project_note"></textarea>
        <app-control-errors
          fieldName="project_note"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--note-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="note">Ghi chú</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <textarea rows="4" nz-input formControlName="note" id="note"></textarea>
        <app-control-errors
          fieldName="note"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--result-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="result">Kết quả</nz-form-label>
      <nz-form-control [nzMd]="12" [nzXs]="24">
        <nz-radio-group formControlName="result">
          <label nz-radio
                 *ngFor="let result of optionResultField"
                 [nzValue]="result">
            {{resultEnum[result]}}
          </label>
        </nz-radio-group>
        <app-control-errors
          fieldName="result"
        ></app-control-errors>
      </nz-form-control>
    </nz-form-item>

    <!--customer project-->
    <nz-form-item>
      <nz-form-label [nzMd]="6" [nzXs]="24" nzFor="customer_project">Dự án</nz-form-label>
      <nz-form-control class="customer-project" [nzMd]="12" [nzXs]="24">
        <nz-radio-group
          [(ngModel)]="radioProject"
          [ngModelOptions]="{ standalone: true }"
          (ngModelChange)="changeRadioProject()"
        >
          <label nz-radio [nzValue]="false">
            <nz-select
              [nzDisabled]="radioProject"
              nzAllowClear
              nzPlaceHolder="Chọn dự án"
              formControlName="customer_project"
            >
              <nz-option *ngFor="let item of projects"
                         [nzLabel]="item.name"
                         [nzValue]="item.name"></nz-option>
            </nz-select>
          </label>
          <label nz-radio [nzValue]="true">
            <nz-select
              [nzDisabled]="!radioProject"
              nzAllowClear
              nzPlaceHolder="Chọn sản phẩm chuyển nhượng"
              formControlName="customer_project"
            >
              <nz-option *ngFor="let item of projects_new"
                         [nzLabel]="item.name"
                         [nzValue]="item.name"></nz-option>
            </nz-select>
          </label>
        </nz-radio-group>
      </nz-form-control>
    </nz-form-item>

    <div nz-row>
      <div nz-col [nzSpan]="24" class="create-area">
        <button nz-button [routerLink]="['', 'customers']">Quay lại</button>
        <button nz-button nzType="primary"
                [nzLoading]="isLoading"
                (click)="confirmUpdate()">
          {{record ? 'Cập nhật' : 'Tạo mới'}}
        </button>
      </div>
    </div>
  </form>
</nz-card>
